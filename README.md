# Сжатие и конвертация файлов из контекстного меню Windows

Программа добавляет пункты в контекстное меню Windows:
- **"Сжать видео"** - только для видео файлов
- **"Конвертация"** - для фото, видео и аудио файлов (автоматически определяет тип и предлагает форматы)

## Требования

1. **Python 3.6+** - должен быть установлен в системе
2. **FFmpeg** - должен быть установлен и доступен в PATH

### Установка FFmpeg

1. Скачайте FFmpeg с официального сайта: https://ffmpeg.org/download.html
2. Распакуйте архив (например, в `C:\ffmpeg\`)
3. Добавьте путь к `bin` в переменную окружения PATH:
   - Откройте "Параметры системы" → "Дополнительные параметры системы"
   - Нажмите "Переменные среды"
   - В "Системные переменные" найдите `Path` и нажмите "Изменить"
   - Добавьте путь `C:\ffmpeg\bin` (или ваш путь)
   - Нажмите "ОК" во всех окнах

Альтернативно, можно поместить `ffmpeg.exe` в одну из стандартных папок:
- `C:\ffmpeg\bin\ffmpeg.exe`
- `C:\Program Files\ffmpeg\bin\ffmpeg.exe`

## Установка

1. Скопируйте все файлы проекта в папку (например, `C:\video_compressor\`)

2. Запустите `install.bat` **от имени администратора**:
   - Правый клик на `install.bat`
   - Выберите "Запуск от имени администратора"

3. После установки перезапустите проводник Windows:
   - Нажмите `Ctrl + Shift + Esc` для открытия диспетчера задач
   - Найдите "Проводник" (explorer.exe)
   - Правый клик → "Перезапустить"

   Или просто перезагрузите компьютер.

## Использование

### Сжатие видео

1. Найдите видео файл в проводнике Windows
2. Правый клик на файле
3. Выберите "Сжать видео"
4. Дождитесь завершения сжатия

Сжатое видео будет сохранено в той же папке с добавлением `compresed001` перед расширением файла.

Например:
- Исходный файл: `video.mp4`
- Сжатый файл: `videocompresed001.mp4`

### Конвертация файлов

1. Найдите файл (фото, видео или аудио) в проводнике Windows
2. Правый клик на файле
3. Выберите "Конвертация"
4. Программа автоматически определит тип файла и предложит доступные форматы
5. Выберите нужный формат из списка
6. Дождитесь завершения конвертации

Конвертированный файл будет сохранен в той же папке.

**Поддерживаемые форматы для конвертации:**

**Видео:** MP4, AVI, MOV, MKV, WebM, WMV, FLV

**Аудио:** MP3, WAV, FLAC, AAC, OGG, M4A, Opus

**Изображения:** JPG, PNG, WebP, BMP, TIFF, GIF

## Удаление

Для удаления пунктов из контекстного меню:

1. Запустите `uninstall.bat` **от имени администратора**
2. Перезапустите проводник Windows

## Ручная установка

Если автоматическая установка не работает, можно установить вручную:

```bash
python install_context_menu.py
```

(Требуются права администратора)

## Ручное удаление

```bash
python install_context_menu.py --remove
```

(Требуются права администратора)

## Прямое использование скриптов

### Сжатие видео

Скрипт сжатия можно использовать напрямую из командной строки:

```bash
python compress_video.py "путь\к\видео\файл.mp4"
```

### Конвертация файлов

Скрипт конвертации можно использовать напрямую из командной строки:

```bash
python convert_video.py "путь\к\файлу"
```

Программа автоматически определит тип файла (видео/аудио/изображение) и предложит доступные форматы для конвертации.

## Настройка качества сжатия

По умолчанию используется среднее качество сжатия. Для изменения откройте `compress_video.py` и измените параметр `quality` в функции `main()`:

- `'low'` - низкое качество, максимальное сжатие
- `'medium'` - среднее качество (по умолчанию)
- `'high'` - высокое качество, минимальное сжатие

## Поддерживаемые форматы

- MP4 (.mp4)
- AVI (.avi)
- MOV (.mov)
- MKV (.mkv)
- WMV (.wmv)
- FLV (.flv)
- WebM (.webm)
- M4V (.m4v)
- 3GP (.3gp)
- MPG/MPEG (.mpg, .mpeg)

## Устранение неполадок

### "ffmpeg не найден в системе"
- Убедитесь, что FFmpeg установлен
- Проверьте, что FFmpeg добавлен в PATH
- Перезапустите командную строку после изменения PATH

### "Недостаточно прав для изменения реестра"
- Запустите скрипт установки от имени администратора

### Пункт меню не появляется
- Убедитесь, что вы перезапустили проводник Windows
- Попробуйте перезагрузить компьютер
- Проверьте, что установка прошла успешно

### Ошибки при сжатии
- Убедитесь, что исходный файл не поврежден
- Проверьте, что на диске достаточно свободного места
- Убедитесь, что файл не открыт в другой программе

## Структура проекта

```
.
├── compress_video.py          # Скрипт сжатия видео
├── convert_video.py           # Скрипт конвертации видео
├── install_context_menu.py    # Скрипт для работы с реестром
├── install.bat                # Установка (запуск от админа)
├── uninstall.bat              # Удаление (запуск от админа)
├── requirements.txt           # Зависимости (не требуются)
└── README.md                  # Документация
```

## Лицензия

Свободное использование.
